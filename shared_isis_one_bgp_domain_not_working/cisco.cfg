hostname xrv2
username admin
 group root-lr
 group cisco-support
 secret 10 $6$Yk7SA1QW5nslAA1.$2vaSMWTbKtt9r02EDxFUhHcE4Mhrz.VyIxyohcLcPKNa25HaZKQsV5LUwLZLCvjwXINQbNT20iGXjqzEYv5bA1
!
username root
 group root-lr
 group cisco-support
 secret 10 $6$X2Ajc//n9OwW4c/.$rO.dDYWV3//UYnDKzOL3RC.B/hm9EZShwYeuqaJnyTqU3Ysvigj3hYSVypmrZ24UY5RuNMFqEGGC3Cse0Mg8K0
!
vrf A
 !vrf A
 rd 200:1
 address-family ipv4 unicast
  import route-target
   200:1
  !
  export route-target
   200:1
  !       
 !
!
call-home
 service active
 contact smart-licensing
 profile CiscoTAC-1
  active
  destination transport-method email disable
  destination transport-method http
 !
!
interface Loopback0
 ipv4 address 1.1.1.2 255.255.255.255
!
interface Loopback100
 vrf A
 ipv4 address 11.11.11.2 255.255.255.255
!
interface MgmtEth0/RP0/CPU0/0
 shutdown
!
interface GigabitEthernet0/0/0/0
 mtu 1714 
 ipv4 address 10.0.0.1 255.255.255.254
!
interface GigabitEthernet0/0/0/1
 mtu 1714
 ipv4 address 10.0.0.6 255.255.255.254
!
interface GigabitEthernet0/0/0/2
 ipv4 address 20.0.0.2 255.255.255.254
!
interface GigabitEthernet0/0/0/3
 shutdown
!
interface GigabitEthernet0/0/0/4
 shutdown
 l2transport
 !
!
interface GigabitEthernet0/0/0/5
 shutdown
!
interface GigabitEthernet0/0/0/6
 shutdown
!         
prefix-set L0-AS200
  1.1.1.0/24 ge 32 le 32
end-set
!
route-policy L0-AS200
  if destination in L0-AS200 then
    done
  else
    drop
  endif
end-policy
!
route-policy ACCEPT-ALL
  pass
end-policy
!
router isis 100
 is-type level-1
 net 49.0000.0010.0100.1002.00
 address-family ipv4 unicast
  metric-style wide level 1
 !
 interface Loopback0
  passive
  address-family ipv4 unicast
  !
 !
 interface GigabitEthernet0/0/0/0
  point-to-point
  address-family ipv4 unicast
  !
 !
 interface GigabitEthernet0/0/0/1
  point-to-point
  address-family ipv4 unicast
  !
 !
 interface GigabitEthernet0/0/0/2
  point-to-point
  address-family ipv4 unicast
  !
 !
!
router bgp 100
 bgp router-id 1.1.1.2
 address-family ipv4 unicast
 !
 address-family vpnv4 unicast
 !
 neighbor 1.1.1.10
  remote-as 100
  update-source Loopback0
  address-family vpnv4 unicast
   soft-reconfiguration inbound
  !
 !
 vrf A
  address-family ipv4 unicast
   redistribute connected
  !
 !
!
l2vpn
 xconnect group XCONNS_UZLETI
  p2p XCONN112
   neighbor ipv4 1.1.11.2 pw-id 112
   !
  !
 !        
!
mpls ldp
 log
  neighbor
  nsr
  graceful-restart
  session-protection
 !
 router-id 1.1.1.2
 session protection
 interface GigabitEthernet0/0/0/0
 !
 interface GigabitEthernet0/0/0/1
 !
 interface GigabitEthernet0/0/0/2
 !
!
lldp
!
end

set version 23.2R1-S1.6
set groups CORE-INTF interfaces <*> mtu 9192
set groups CORE-INTF interfaces <*> link-mode full-duplex
set groups CORE-INTF interfaces <*> gigether-options no-auto-negotiation
set groups CORE-INTF interfaces <*> unit 0 family iso
set groups CORE-INTF interfaces <*> unit 0 family mpls maximum-labels 5
set groups ISIS protocols isis interface <*> ldp-synchronization
set groups ISIS protocols isis interface <*> link-protection
set groups ISIS protocols isis interface <*> point-to-point
set groups OSPF
set system host-name vmx2
set system root-authentication encrypted-password "$6$yHNjOZ1P$NfDqg1Ko8w3Xb9IFlvS5Fm5A.sWq8c74gJL5Vhwgw6YtoQ4DZyzf.M0iSTP1ShIMIFXZTt1ejsrXKBNOJTWwL."
set chassis network-services enhanced-ip
set interfaces ge-0/0/0 apply-groups CORE-INTF
set interfaces ge-0/0/0 unit 0 family inet address 11.0.0.1/31
set interfaces ge-0/0/1 apply-groups CORE-INTF
set interfaces ge-0/0/1 unit 0 family inet address 11.0.0.6/31
set interfaces ge-0/0/2 apply-groups CORE-INTF
set interfaces ge-0/0/2 unit 0 family inet address 20.0.0.3/31
set interfaces ge-0/0/4 encapsulation ethernet-ccc
set interfaces ge-0/0/4 unit 0 family ccc
set interfaces lo0 unit 0 family inet address 1.1.11.2/32
set interfaces lo0 unit 0 family iso address 49.0000.0010.0101.1002.00
set interfaces lo0 unit 100 family inet address 12.12.12.2/32
set policy-options policy-statement L0-AS100 term L0-AS100 from rib inet.3
set policy-options policy-statement L0-AS100 term L0-AS100 from route-filter 1.1.11.0/24 prefix-length-range /32-/32
set policy-options policy-statement L0-AS100 term L0-AS100 then accept
set policy-options policy-statement LOAD-BALANCE then load-balance per-packet
set policy-options policy-statement TO-CORE term LOCAL-LOOPBACK from protocol direct
set policy-options policy-statement TO-CORE term LOCAL-LOOPBACK from rib inet.0
set policy-options policy-statement TO-CORE term LOCAL-LOOPBACK from interface lo0.0
set policy-options policy-statement TO-CORE term LOCAL-LOOPBACK from route-filter 0.0.0.0/0 prefix-length-range /32-/32
set policy-options policy-statement TO-CORE term LOCAL-LOOPBACK then accept
set policy-options policy-statement TO-CORE term REMOTE-LOOPBACKS from protocol bgp
set policy-options policy-statement TO-CORE term REMOTE-LOOPBACKS from route-filter 0.0.0.0/0 prefix-length-range /32-/32
set policy-options policy-statement TO-CORE term REMOTE-LOOPBACKS then metric igp
set policy-options policy-statement TO-CORE term REMOTE-LOOPBACKS then next-hop self
set policy-options policy-statement TO-CORE term REMOTE-LOOPBACKS then accept
set policy-options policy-statement TO-CORE term FROM-AGG-PES from family inet-vpn
set policy-options policy-statement TO-CORE term FROM-AGG-PES from protocol bgp
set policy-options policy-statement TO-CORE term FROM-AGG-PES then next-hop self
set policy-options policy-statement TO-CORE term FROM-AGG-PES then accept
set policy-options policy-statement TO-CORE term ROUTE-TARGET-FILTERING from protocol route-target
set policy-options policy-statement TO-CORE term ROUTE-TARGET-FILTERING from protocol bgp
set policy-options policy-statement TO-CORE term ROUTE-TARGET-FILTERING from rib bgp.rtarget.0
set policy-options policy-statement TO-CORE term ROUTE-TARGET-FILTERING then next-hop self
set policy-options policy-statement TO-CORE term ROUTE-TARGET-FILTERING then accept
set policy-options policy-statement TO-CORE then reject
set policy-options policy-statement leak-L2-to-L1 from protocol isis
set policy-options policy-statement leak-L2-to-L1 from level 2
set policy-options policy-statement leak-L2-to-L1 from route-filter 1.1.11.0/24 prefix-length-range /32-/32
set policy-options policy-statement leak-L2-to-L1 to protocol isis
set policy-options policy-statement leak-L2-to-L1 to level 1
set policy-options policy-statement leak-L2-to-L1 then accept
set routing-instances A instance-type vrf
set routing-instances A interface lo0.100
set routing-instances A route-distinguisher 1.1.11.2:1
set routing-instances A vrf-target target:200:1
set routing-instances A vrf-table-label
set routing-options router-id 1.1.11.2
set routing-options autonomous-system 100
set routing-options forwarding-table export LOAD-BALANCE
set protocols bgp group RR type internal
set protocols bgp group RR local-address 1.1.11.2
set protocols bgp group RR advertise-inactive
set protocols bgp group RR family inet labeled-unicast resolve-vpn
set protocols bgp group RR family inet-vpn unicast
set protocols bgp group RR family l2vpn signaling
set protocols bgp group RR family route-target
set protocols bgp group RR export TO-CORE
set protocols bgp group RR neighbor 1.1.11.10 description RR
set protocols bgp group AS200 type external
set protocols bgp group AS200 local-address 20.0.0.3
set protocols bgp group AS200 family inet labeled-unicast rib inet.3
set protocols bgp group AS200 family inet-vpn unicast
set protocols bgp group AS200 family l2vpn signaling
set protocols bgp group AS200 export L0-AS100
set protocols bgp group AS200 neighbor 20.0.0.2 description xrv1
set protocols bgp group AS200 neighbor 20.0.0.2 peer-as 200
set protocols isis apply-groups ISIS
set protocols isis interface ge-0/0/0.0
set protocols isis interface ge-0/0/1.0
set protocols isis interface ge-0/0/2.0
set protocols isis interface all disable
set protocols isis interface lo0.0 passive
set protocols isis level 2 wide-metrics-only
set protocols isis level 1 wide-metrics-only
set protocols isis reference-bandwidth 1000g
set protocols isis overload timeout 120
set protocols l2circuit neighbor 1.1.1.2 interface ge-0/0/4.0 virtual-circuit-id 112
set protocols l2circuit neighbor 1.1.1.2 interface ge-0/0/4.0 no-control-word
set protocols ldp interface ge-0/0/0.0
set protocols ldp interface ge-0/0/1.0
set protocols ldp interface ge-0/0/2.0
set protocols ldp interface lo0.0
set protocols mpls interface ge-0/0/0.0
set protocols mpls interface ge-0/0/1.0
set protocols mpls interface ge-0/0/2.0
set protocols lldp port-id-subtype interface-name
set protocols lldp interface all

