set version 23.2R1-S1.6
set groups METRO-INTF interfaces <*> mtu 9192
set groups METRO-INTF interfaces <*> link-mode full-duplex
set groups METRO-INTF interfaces <*> gigether-options no-auto-negotiation
set groups METRO-INTF interfaces <*> unit 0 family iso
set groups METRO-INTF interfaces <*> unit 0 family mpls maximum-labels 3
set groups OSPF protocols ospf area <*> interface <*> interface-type p2p
set system host-name vmx6
set system root-authentication encrypted-password "$6$4xJgCxrz$RIom79k/cDB2cRWWR0rY4a7Bl4rvt5k/e3/L.He0QrrXfp3Hc90.XRd8a.kE0CnYRlEkj1gElCZ5BBBbaehnc1"
set chassis network-services enhanced-ip
set interfaces ge-0/0/0 apply-groups METRO-INTF
set interfaces ge-0/0/0 unit 0 family inet address 12.0.0.1/31
set interfaces ge-0/0/2 encapsulation ethernet-vpls
set interfaces ge-0/0/2 unit 0 family vpls
set interfaces ge-0/0/3 apply-groups METRO-INTF
set interfaces ge-0/0/3 unit 0 family inet address 12.0.0.5/31
set interfaces lo0 unit 0 family inet address 1.1.56.6/32
set interfaces lo0 unit 100 family inet address 12.12.12.6/32
set policy-options prefix-list LOCAL-LOOPBACK apply-path "interfaces lo0 unit 0 family inet address <*>"
set policy-options policy-statement LOAD-BALANCE then load-balance per-packet
set policy-options policy-statement LOOPBACK-LU-LABEL term 1 from prefix-list LOCAL-LOOPBACK
set policy-options policy-statement LOOPBACK-LU-LABEL term 1 then accept
set firewall family evpn filter EVPN_FLOOD_FILTER term 10 from traffic-type unknown-unicast
set firewall family evpn filter EVPN_FLOOD_FILTER term 10 then policer EVPN_POLICE_UNKNOWN_UNICAST
set firewall family evpn filter EVPN_FLOOD_FILTER term 10 then count EVPN_POLICE_UNKNOWN_UNICAST
set firewall family evpn filter EVPN_FLOOD_FILTER term 20 from traffic-type multicast
set firewall family evpn filter EVPN_FLOOD_FILTER term 20 then policer EVPN_POLICE_MULTICAST
set firewall family evpn filter EVPN_FLOOD_FILTER term 20 then count EVPN_POLICE_MULTICAST
set firewall family evpn filter EVPN_FLOOD_FILTER term 30 from traffic-type broadcast
set firewall family evpn filter EVPN_FLOOD_FILTER term 30 then policer EVPN_POLICE_BROADCAST
set firewall family evpn filter EVPN_FLOOD_FILTER term 30 then count EVPN_POLICE_BROADCAST
set firewall policer EVPN_POLICE_BROADCAST if-exceeding bandwidth-limit 1m
set firewall policer EVPN_POLICE_BROADCAST if-exceeding burst-size-limit 50k
set firewall policer EVPN_POLICE_BROADCAST then discard
set firewall policer EVPN_POLICE_MULTICAST if-exceeding bandwidth-limit 4m
set firewall policer EVPN_POLICE_MULTICAST if-exceeding burst-size-limit 100k
set firewall policer EVPN_POLICE_MULTICAST then discard
set firewall policer EVPN_POLICE_UNKNOWN_UNICAST if-exceeding bandwidth-limit 250k
set firewall policer EVPN_POLICE_UNKNOWN_UNICAST if-exceeding burst-size-limit 50k
set firewall policer EVPN_POLICE_UNKNOWN_UNICAST then discard
set routing-instances A instance-type vrf
set routing-instances A interface lo0.100
set routing-instances A route-distinguisher 1.1.56.6:1
set routing-instances A vrf-target target:100:1
set routing-instances A vrf-table-label
set routing-instances EVPN1 instance-type evpn
set routing-instances EVPN1 protocols evpn
set routing-instances EVPN1 forwarding-options family evpn flood input EVPN_FLOOD_FILTER
set routing-instances EVPN1 interface ge-0/0/2.0
set routing-instances EVPN1 route-distinguisher 1.1.56.6:1001
set routing-instances EVPN1 vrf-target target:100:1001
set routing-options router-id 1.1.56.6
set routing-options autonomous-system 100
set routing-options forwarding-table export LOAD-BALANCE
set protocols bgp group METRO-REGIO type internal
set protocols bgp group METRO-REGIO local-address 1.1.56.6
set protocols bgp group METRO-REGIO family inet labeled-unicast resolve-vpn
set protocols bgp group METRO-REGIO family inet-vpn unicast
set protocols bgp group METRO-REGIO family inet6 unicast
set protocols bgp group METRO-REGIO family l2vpn signaling
set protocols bgp group METRO-REGIO family evpn signaling
set protocols bgp group METRO-REGIO family route-target
set protocols bgp group METRO-REGIO export LOOPBACK-LU-LABEL
set protocols bgp group METRO-REGIO multipath
set protocols bgp group METRO-REGIO neighbor 1.1.11.3 description vmx3
set protocols bgp group METRO-REGIO neighbor 1.1.11.4 description vmx4
set protocols ldp transport-address router-id
set protocols ldp interface ge-0/0/3.0
set protocols ldp interface lo0.0
set protocols mpls interface ge-0/0/0.0
set protocols mpls interface ge-0/0/3.0
set protocols ospf apply-groups OSPF
set protocols ospf area 0.0.0.56 interface lo0.0 passive
set protocols ospf area 0.0.0.56 interface ge-0/0/3.0
set protocols ospf area 0.0.0.56 interface ge-0/0/0.0
set protocols ospf reference-bandwidth 1000g
set protocols lldp port-id-subtype interface-name
set protocols lldp interface all

